<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=GB2312" />
		<title>PIM-UserUI</title>
		<script type="text/javascript" src="js/jquery-1.5.1.min.js"></script>
        <script type="text/javascript" src="js/jquery-calendar.js"></script>
		<script type="text/javascript" src="js/jquery-ui-1.8.14.custom.min.js"></script>
        
		<link rel="stylesheet" type="text/css" href="css/ui-lightness/jquery-ui-1.8.14.custom.css">
        <link rel="stylesheet" type="text/css" href="css/jquery-calendar.css">
		
		<style type="text/css">
			body 				{	margin: 50px;	font-size: 12px;}
			span.button 		{	text-decoration: underline;	cursor: pointer;}
			select.targetlist 	{	height: 180px;	width: 600px;}
			textarea.targetdesc {	height: 180px;	width: 300px;}
        </style>	
        
		<script type="text/javascript">
			$(function(){

				// Set the Date and Time dailog
				$(".calendarFocus").calendar();
				$("#newreqeust").hide(); // Hide the new request main forms.				
				$("#newr").click( function () { 
					if($(this).text()=="New PIM Request")
					{
						$("#newreqeust").show();
						$(this).text("Hide PIM Request");
					}else{
						$("#newreqeust").hide();
						$(this).text("New PIM Request");
					}
				
				});
				
				
				// Query submit. to search the service name and private account.
				
				$('#selection').submit(function() {
					$.ajax({
						url:'resource.xml',
						type: 'GET',
						dataType: 'xml',//这里可以不写，但千万别写text或者html!!!
						timeout: 1000,
						error: function(xml){
							alert('Error loading XML document'+xml);
						},
						success: function(xml){
							var htmlData = '<table width="100%" border="0" cellpadding="1" cellspacing="1" id="serverpim">';
							htmlData+= '<tr bgcolor="#0099CC">';
							htmlData+= '<td width="30%">Account Infomation</td>';
							htmlData+= '<td width="16%">Start TIME</td>';
							htmlData+= '<td width="21%">End TIME</td>';
							htmlData+= '<td width="33%">Action Or Status</td>';
							htmlData+= '</tr>';
														
							$(xml).find("resource").each(function(i){
								var serverlist = $(this);
								var serveraccout = serverlist.children("AccountID").text();
								var requestor = serverlist.children("Requestor").text();
								var approver = serverlist.children("Approver").text();
								var status = serverlist.children("status").text();

																
								htmlData+= '<tr bgcolor="#BB99CC">';
								htmlData+= '<td>'+serverlist.children("AccountID").text()+'</td>';
								htmlData+= '<td>'+serverlist.children("StartTime").text()+'</td>';
								htmlData+= '<td>'+serverlist.children("EndTime").text()+'</td>';
								if(status.toLowerCase()!="finish")
								{
									htmlData+= '<td>'+requestor+' Has Occupted.</td>';
								}else{
								  
									htmlData+= '<td><input type="button" name="button" id="add'+serveraccout+'" value="add"></td>';
								}
								htmlData+= '</tr>';
							});
							htmlData+= '</talbe>';
							$("#selectionret").empty();
							$("#selectionret").append(htmlData);
						}
					});
					return false;
				});

				
				//$(".calendarFocus").click(function(){alert(popUpCal.parseDate($('.calendarFocus').val()))});
			});

		</script>

	</head>
	
	<body>
    <!-- Welcome Page -->
    <div id="Welcompart">
		<h1>Hello test1, Welcome to PIM Center!	[<a href="">LOGOUT</a>]</h1>
		<h1>The following are your Application recoder: [<span class="button">&lt;</span> 
			<span class="button">&lt;&lt;</span> 
			<span class="button">&gt;&gt;</span> 
			<span class="button">&gt;</span> 
			Page:<input name="cols" type="text" size="2" id="calendar1" value="1"> 
			<span class="button">Go</span> 
			]  <span class="button">Refresh</span>  </h1>
    </div>
    
    <!-- Welcome Page END -->
	
	<!-- HISTORY PAGE -->
    <div id="historys"></div>
	
	<script type="text/javascript">
		var servers="";
		
        $.ajax({
			url:'recoder.xml',
			type: 'GET',
			dataType: 'xml',//这里可以不写，但千万别写text或者html!!!
			timeout: 1000,
			error: function(xml){
				alert('Error loading XML document'+xml);
			},
			success: function(xml){
				var htmlData = '<table width="100%" border="0" cellpadding="1" cellspacing="1" id="historyrecs">';
				htmlData+= '<tr bgcolor="#0099CC" class="taskheader itemnumber">';
				htmlData+= '<td width="8%" align="center" valign="middle">Proccess ID</td>';
				htmlData+= '<td width="13%" align="center" valign="middle">Account Infomation</td>';
				htmlData+= '<td width="12%" align="center" valign="middle">Start TIME</td>';
				htmlData+= '<td width="12%" align="center" valign="middle">End TIME</td>';
				htmlData+= '<td width="29%" align="center" valign="middle">Reason</td>';
				htmlData+= '<td width="6%" align="center" valign="middle">Requestor</td>';
				htmlData+= '<td width="6%" align="center" valign="middle">Approver</td>';
				htmlData+= '<td width="7%" align="center" valign="middle">Status</td>';
				htmlData+= '<td width="9%" align="center" valign="middle">Acction</td>';
				htmlData+= '</tr>';
				
				$(xml).find("serverlist").each(function(i){
					var serverlist = $(this);
					
					htmlData+= '<tr bgcolor="#EE99CC">';
					htmlData+= '<td>'+serverlist.children("ProccessID").text()+'</td>';
					htmlData+= '<td>'+serverlist.children("AccountID").text()+'</td>';
					htmlData+= '<td>'+serverlist.children("StartTime").text()+'</td>';
					htmlData+= '<td>'+serverlist.children("EndTime").text()+'</td>';
					htmlData+= '<td>'+serverlist.children("Reason").text()+'</td>';
					htmlData+= '<td>'+serverlist.children("Requestor").text()+'</td>';
					htmlData+= '<td>'+serverlist.children("Approver").text()+'</td>';
					htmlData+= '<td>'+serverlist.children("Acction").text()+'</td>';
					htmlData+= '<td>Acction</td>';
					htmlData+= '</tr>';
				});
				htmlData+= '</talbe>';
				$("#historys").append(htmlData);
			}
		});
	</script>
	
	<h1><span id="newr" class="button">New PIM Request</span></h1>
	
    <!-- NEW REQUEST PART -->
	<div id="newreqeust">
		
		<!-- New Request Main form -->
		<div id="mainform">
			<form action="" id="MainForm" name="MainForm" method="post">
				<select multiple id="mainlist" class="targetlist">
				  <option>Please chose your target Host and Time Space</option>
				</select>
				<input type="submit" name="add5" id="add5" value="Delete">
				<textarea name="textarea2" id="textarea2" cols="45" rows="10" class="targetdesc">AIX Agent Update,B2 FP5安装,变更号码: 9899887</textarea>
				<input type="submit" name="add6" id="add6" value="Submit">
			</form>
		</div>
		<!-- New Request Main form END -->
		
		
		<!-- Search Part --> 
		<P></P>
		<div id="selections">
		<form action="" id="selection" name="selection" method="post">
		Any Account/IP/Hostname or  * for ALL  
					<input type="text" name="qureystr" id="qureystr" value=""> 
			From    <input type="text" name="fromtime" id="fromtime" value="" class="calendarFocus">
			TO		<input type="text" name="totime" id="totime" value="" class="calendarFocus">
					<input type="checkbox" name="status" id="status">Any Status. 
					<input type="submit" name="querysubmit" id="querysubmit" value="Query">
		</form>
		</div>
		<P></P>
		<!-- Search Part END --> 
	
	
		<!-- Selection result -->
		<div id="selectionret"></div>


	
	</div>  <!-- END NEWREQUEST-->

	
	</body>
</html>


